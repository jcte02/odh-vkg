CREATE MATERIALIZED VIEW fl_accommodation AS 
(SELECT 
  data->>'Id' AS id, 
  (data->>'Beds')::integer AS beds, 
  (data->>'HgvId')::integer AS hgvid,
  (data->'Units')::integer AS units,
  (data->'Active')::boolean AS active,
  data->>'Gpstype' AS gpstype,
  (data->>'HasRoom')::boolean AS hasRoom,
  (data->>'Altitude')::decimal AS altitude,
  (data->>'Latitude')::decimal AS latitude,
  (data->>'TVMember')::boolean AS tvmember,
  (data->>'IsCamping')::boolean AS iscamping,
  (data->>'Longitude')::decimal AS longitude,
  data->>'Shortname' AS shortname,
  (data->>'SmgActive')::boolean AS smgactive,
  data#>>'{AccoDetail,de,Fax}' AS de_fax,
  data#>>'{AccoDetail,de,Zip}' AS de_zip,
  data#>>'{AccoDetail,de,City}' AS de_city,
  data#>>'{AccoDetail,de,Name}' AS de_name,
  data#>>'{AccoDetail,de,Email}' AS de_email,
  data#>>'{AccoDetail,de,Phone}' AS de_phone,
  data#>>'{AccoDetail,de,Mobile}' AS de_mobile,
  data#>>'{AccoDetail,de,Street}' AS de_street,
  data#>>'{AccoDetail,de,Website}' AS de_website,
  data#>>'{AccoDetail,de,Language}' AS de_language,
  data#>>'{AccoDetail,de,Lastname}' AS de_lastname,
  data#>>'{AccoDetail,de,Longdesc}' AS de_longdesc,
  data#>>'{AccoDetail,de,Firstname}' AS de_firstname,
  data#>>'{AccoDetail,de,Shortdesc}' AS de_shortdesc,
  data#>>'{AccoDetail,de,NameAddition}' AS de_nameaddition,
    data#>>'{AccoDetail,it,Fax}' AS it_fax,
  data#>>'{AccoDetail,it,Zip}' AS it_zip,
  data#>>'{AccoDetail,it,City}' AS it_city,
  data#>>'{AccoDetail,it,Name}' AS it_name,
  data#>>'{AccoDetail,it,Email}' AS it_email,
  data#>>'{AccoDetail,it,Phone}' AS it_phone,
  data#>>'{AccoDetail,it,Mobile}' AS it_mobile,
  data#>>'{AccoDetail,it,Street}' AS it_street,
  data#>>'{AccoDetail,it,Website}' AS it_website,
  data#>>'{AccoDetail,it,Language}' AS it_language,
  data#>>'{AccoDetail,it,Lastname}' AS it_lastname,
  data#>>'{AccoDetail,it,Longdesc}' AS it_longdesc,
  data#>>'{AccoDetail,it,Firstname}' AS it_firstname,
  data#>>'{AccoDetail,it,Shortdesc}' AS it_shortdesc,
  data#>>'{AccoDetail,it,NameAddition}' AS it_nameaddition,
    data#>>'{AccoDetail,en,Fax}' AS en_fax,
  data#>>'{AccoDetail,en,Zip}' AS en_zip,
  data#>>'{AccoDetail,en,City}' AS en_city,
  data#>>'{AccoDetail,en,Name}' AS en_name,
  data#>>'{AccoDetail,en,Email}' AS en_email,
  data#>>'{AccoDetail,en,Phone}' AS en_phone,
  data#>>'{AccoDetail,en,Mobile}' AS en_mobile,
  data#>>'{AccoDetail,en,Street}' AS en_street,
  data#>>'{AccoDetail,en,Website}' AS en_website,
  data#>>'{AccoDetail,en,Language}' AS en_language,
  data#>>'{AccoDetail,en,Lastname}' AS en_lastname,
  data#>>'{AccoDetail,en,Longdesc}' AS en_longdesc,
  data#>>'{AccoDetail,en,Firstname}' AS en_firstname,
  data#>>'{AccoDetail,en,Shortdesc}' AS en_shortdesc,
  data#>>'{AccoDetail,en,NameAddition}' AS en_nameaddition,
  data->>'AccoTypeId' AS accotypeid,
  data->>'DistrictId' AS districtid,
  (data->>'isBookable')::boolean AS isbookable,
  data->>'LastChange' AS lastchange,
  data->>'TrustYouID' AS trustyouid,
  data->>'FirstImport' AS firstimport,
  data->>'GastronomyId' AS gastronomyid,
  data#>>'{LocationInfo,TvInfo,Id}' AS tvinfo_id,
  -- data#>>'{LocationInfo,TvInfo,Name,cs}' AS cs_tvinfo_name
  data#>>'{LocationInfo,AreaInfo,Id}' AS areainfo_id,
  data#>>'{LocationInfo,RegionInfo,Id}' AS regioninfo_id,
  data#>>'{LocationInfo,DistrictInfo,Id}' AS districtinfo_id,
  data#>>'{LocationInfo,MunicipalityInfo,Id}' AS municipalityinfo_id,
  data->>'MainLanguage' AS mainlanguage,
  data->>'TrustYouScore' AS trustyouscore,
  data->>'TrustYouState' AS trustyoustate,
  data->>'AccoCategoryId' AS accocategoryid,
  (data->>'Representation')::integer AS representation,
  (data->>'TrustYouActive')::boolean AS trustyouactive,
  data->>'IndependentData' AS independentdata,
  (data->>'IsAccommodation')::boolean AS isaccommodation,
  data->>'TourismVereinId' AS tourismvereinid,
  (data->>'TrustYouResults')::integer AS trustyouresults,
  data->>'AltitudeUnitofMeasure' AS altitudeunitofmeasure
FROM accommodationsopen);


